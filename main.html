<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Login Form</title>
</head>
<body>

<h1>Login Form</h1>

<form id="loginForm">

  <input
    type="text"
    id="username"
    placeholder="Username"
  />

  <input
    type="password"
    id="password"
    placeholder="Password"
  />

  <label>
    <input type="checkbox" id="checkbox" />
    Remember me.
  </label>

  <input
    type="submit"
    id="submit"
    value="Submit"
  />

</form>

<button id="existing" style="display:none;">
  Login as existing user
</button>

<script>
  const form = document.getElementById("loginForm");
  const usernameInput = document.getElementById("username");
  const passwordInput = document.getElementById("password");
  const checkbox = document.getElementById("checkbox");
  const existingBtn = document.getElementById("existing");

  /* ---------------------------
     Show button if data exists
  ----------------------------*/
  function checkExistingUser() {
    const user = localStorage.getItem("username");
    const pass = localStorage.getItem("password");

    if (user && pass) {
      existingBtn.style.display = "block";
    } else {
      existingBtn.style.display = "none";
    }
  }

  // Run immediately (important for Cypress)
  checkExistingUser();

  /* ---------------------------
     Submit Form
  ----------------------------*/
  form.addEventListener("submit", function (e) {
    e.preventDefault();

    const username = usernameInput.value;
    const password = passwordInput.value;

    alert(`Logged in as ${username}`);

    if (checkbox.checked) {
      localStorage.setItem("username", username);
      localStorage.setItem("password", password);
    } else {
      localStorage.removeItem("username");
      localStorage.removeItem("password");
    }

    checkExistingUser();
  });

  /* ---------------------------
     Existing User Login
  ----------------------------*/
  existingBtn.addEventListener("click", function () {
    const savedUser = localStorage.getItem("username");

    if (savedUser) {
      alert(`Logged in as ${savedUser}`);
    }
  });
</script>

</body>
</html>

